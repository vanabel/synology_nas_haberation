# NAS æœåŠ¡ç®¡ç†è„šæœ¬

> ä¸€å¥—ä¼˜åŒ–çš„Synology NASæœåŠ¡å¯åŠ¨/åœæ­¢è„šæœ¬ï¼Œæ”¯æŒæ™ºèƒ½æ£€æŸ¥ã€çŠ¶æ€éªŒè¯ã€é”™è¯¯è¿‡æ»¤

**ç‰ˆæœ¬**: v2.1  
**æ›´æ–°æ—¶é—´**: 2026-02-08  
**ä½œè€…**: Cursor AI

---

## ğŸ“ è„šæœ¬åˆ—è¡¨

| è„šæœ¬ | åŠŸèƒ½ | ä½¿ç”¨æ–¹å¼ |
|------|------|---------|
| `start_services_enhanced.sh` | å¯åŠ¨æ‰€æœ‰æœåŠ¡ | `sudo bash start_services_enhanced.sh` |
| `stop_services_enhanced.sh` | åœæ­¢æ‰€æœ‰æœåŠ¡ | `sudo bash stop_services_enhanced.sh` |
| `test_service_status.sh` | æ£€æŸ¥æœåŠ¡çŠ¶æ€ | `bash test_service_status.sh` |
| `diagnose_hibernation.sh` | è¯Šæ–­ç¡¬ç›˜ä¼‘çœ é—®é¢˜ | `bash diagnose_hibernation.sh` |

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å¯åŠ¨æ‰€æœ‰æœåŠ¡
```bash
sudo bash /var/services/homes/vanabel/scripts/start_services_enhanced.sh
```

### 2. åœæ­¢æ‰€æœ‰æœåŠ¡
```bash
sudo bash /var/services/homes/vanabel/scripts/stop_services_enhanced.sh
```

### 3. æ£€æŸ¥æœåŠ¡çŠ¶æ€
```bash
bash /var/services/homes/vanabel/scripts/test_service_status.sh
```

### 4. è¯Šæ–­ä¼‘çœ é—®é¢˜
```bash
bash /var/services/homes/vanabel/scripts/diagnose_hibernation.sh
```

---

## âœ¨ v2 ç‰ˆæœ¬ç‰¹æ€§

### ğŸ¯ æ ¸å¿ƒæ”¹è¿›

| ç‰¹æ€§ | è¯´æ˜ |
|------|------|
| **æ™ºèƒ½å¯åŠ¨** | è‡ªåŠ¨è·³è¿‡å·²è¿è¡Œçš„æœåŠ¡ |
| **å¯ç”¨æ£€æŸ¥** | åªå¯åŠ¨å·²å¯ç”¨çš„æœåŠ¡ï¼Œè·³è¿‡å·²ç¦ç”¨çš„ |
| **ä¾èµ–ç®¡ç†** | Redisç­‰ä¾èµ–æœåŠ¡ä½¿ç”¨æ™ºèƒ½è½®è¯¢ç­‰å¾… |
| **æ¸…æ™°åé¦ˆ** | ä½¿ç”¨ âœ“ å’Œ âš  ç¬¦å·æ˜¾ç¤ºçŠ¶æ€ |
| **é”™è¯¯è¿‡æ»¤** | è¿‡æ»¤systemdçš„è¯¯å¯¼æ€§é”™è¯¯æ¶ˆæ¯ |
| **è¿›ç¨‹éªŒè¯** | éªŒè¯å¯åŠ¨/åœæ­¢æ˜¯å¦æˆåŠŸ |

### ğŸ“Š è¾“å‡ºç¤ºä¾‹

```
========================================
Sun Feb  8 10:00:00 AM CST 2026: å¼€å§‹å¯åŠ¨æœåŠ¡ (å¢å¼ºç‰ˆ-ä¼˜åŒ– v2)
=== [1/10] å¯åŠ¨è™šæ‹ŸåŒ–æœåŠ¡ ===
  Rediså·²åœ¨è¿è¡Œ
  âœ“ è™šæ‹ŸåŒ–æœåŠ¡å·²å¯åŠ¨
=== [2/10] å¯åŠ¨Synology Drive ===
  âœ“ DriveæœåŠ¡å·²å¯åŠ¨
=== [3/10] å¯åŠ¨CloudSync ===
  CloudSyncå·²ç¦ç”¨,è·³è¿‡
=== [7/10] å¯åŠ¨Nginx ===
  âœ“ Nginxå·²å¯åŠ¨
========================================
âœ“ æœåŠ¡å¯åŠ¨æµç¨‹å®Œæˆ!
```

---

## ğŸ“ ç®¡ç†çš„æœåŠ¡

### ç³»ç»ŸæœåŠ¡
- âœ“ è™šæ‹ŸåŒ–æœåŠ¡ (Virtualization + Redis)
- âœ“ Synology Drive
- âœ“ CloudSync
- âœ“ æ–‡ä»¶ç´¢å¼•æœåŠ¡
- âœ“ Synology Photos
- âœ“ EmbyServer

### WebæœåŠ¡
- âœ“ Nginx
- âœ“ PHP-FPM (æ‰€æœ‰å®ä¾‹)
- âœ“ Apache (å¦‚æœå®‰è£…)

### ç”¨æˆ·åº”ç”¨
- âœ“ PM2ç®¡ç†çš„Node.jsåº”ç”¨

### å®¹å™¨
- âœ“ Dockerå®¹å™¨ (æ˜¾ç¤ºæç¤ºä¿¡æ¯)

---

## ğŸ¯ ä½¿ç”¨åœºæ™¯

### åœºæ™¯1: å¤œé—´èŠ‚èƒ½æ¨¡å¼
```bash
# æ™šä¸Šåœæ­¢ä¸éœ€è¦çš„æœåŠ¡
sudo bash stop_services_enhanced.sh
# é¢„æœŸæ•ˆæœ: ç£ç›˜I/Oé™ä½70-90%
```

### åœºæ™¯2: æ—©ä¸Šæ¢å¤æœåŠ¡
```bash
# æ—©ä¸Šå¯åŠ¨æ‰€æœ‰æœåŠ¡
sudo bash start_services_enhanced.sh
# ç­‰å¾…2-3åˆ†é’Ÿ
sleep 180
# éªŒè¯çŠ¶æ€
bash test_service_status.sh
```

### åœºæ™¯3: é‡å¯åå¿«é€Ÿæ¢å¤
```bash
# ç³»ç»Ÿé‡å¯åä¸€é”®å¯åŠ¨
sudo bash start_services_enhanced.sh
```

---

## âš™ï¸ é…ç½®è¯´æ˜

### æ—¥å¿—æ–‡ä»¶ä½ç½®
```
/var/services/homes/vanabel/logs/service_start_enhanced.log
/var/services/homes/vanabel/logs/service_stop_enhanced.log
```

### è™šæ‹Ÿæœºä¿æŠ¤
åœæ­¢è„šæœ¬ä¼šè‡ªåŠ¨æ£€æµ‹è¿è¡Œä¸­çš„è™šæ‹Ÿæœºã€‚å¦‚æœGUIæ˜¾ç¤ºæœ‰VMä½†è„šæœ¬æœªæ£€æµ‹åˆ°ï¼Œè¯·æ‰‹åŠ¨æ³¨é‡Šæ‰è™šæ‹ŸåŒ–æœåŠ¡åœæ­¢éƒ¨åˆ†ã€‚

---

## ğŸ”§ æ•…éšœæ’æŸ¥

### é—®é¢˜1: çœ‹åˆ° "dependency job failed" é”™è¯¯
**è§£ç­”**: è¿™æ˜¯è¯¯å¯¼æ€§æ¶ˆæ¯ï¼Œv2ç‰ˆæœ¬å·²è¿‡æ»¤ã€‚æ£€æŸ¥å®é™…æœåŠ¡çŠ¶æ€ï¼š
```bash
systemctl status <æœåŠ¡å>
```

### é—®é¢˜2: PM2åº”ç”¨æœªå¯åŠ¨
**è§£ç­”**: ä»¥vanabelç”¨æˆ·æ£€æŸ¥ï¼š
```bash
su - vanabel
pm2 list
pm2 logs
```

### é—®é¢˜3: æœåŠ¡æ˜¾ç¤º"å·²ç¦ç”¨,è·³è¿‡"
**è§£ç­”**: è¿™æ˜¯æ­£å¸¸çš„ã€‚å¦‚éœ€å¯ç”¨æœåŠ¡ï¼š
```bash
sudo systemctl enable <æœåŠ¡å>
sudo systemctl start <æœåŠ¡å>
```

---

## ğŸ“– ç›¸å…³æ–‡æ¡£

- **CHANGELOG.md** - å®Œæ•´çš„ç‰ˆæœ¬å†å²å’Œä¿®å¤è®°å½•
- **HIBERNATION_GUIDE.md** - ç¡¬ç›˜ä¼‘çœ é—®é¢˜è¯Šæ–­å’Œè§£å†³æ–¹æ¡ˆ

---

## ğŸ”‘ æƒé™è¯´æ˜

### ä¸ºä»€ä¹ˆéœ€è¦sudo/rootï¼Ÿ

| æ“ä½œ | éœ€è¦çš„æƒé™ | åŸå›  |
|------|-----------|------|
| PM2 stop/start | vanabelç”¨æˆ· | PM2ä»¥vanabelè¿è¡Œ |
| Nginx/PHP/Apache | **rootæƒé™** | ç³»ç»ŸæœåŠ¡éœ€è¦root |
| Docker | **rootæƒé™** | /var/run/docker.sock éœ€è¦root |
| systemctlå‘½ä»¤ | **rootæƒé™** | ç³»ç»ŸæœåŠ¡æ§åˆ¶éœ€è¦root |

è„šæœ¬ä¼šè‡ªåŠ¨ä½¿ç”¨ `su - vanabel -c "command"` æ¥ä»¥æ­£ç¡®çš„ç”¨æˆ·è¿è¡Œç”¨æˆ·çº§åº”ç”¨ã€‚

---

## ğŸ’¡ æç¤º

1. **é¦–æ¬¡ä½¿ç”¨**: å»ºè®®å…ˆè¿è¡Œ `test_service_status.sh` äº†è§£å½“å‰çŠ¶æ€
2. **æ—¥å¿—æ£€æŸ¥**: æ‰€æœ‰æ“ä½œéƒ½ä¼šè®°å½•æ—¥å¿—ï¼Œæ–¹ä¾¿å›æº¯
3. **æ¸è¿›å¼åœæ­¢**: åœæ­¢è„šæœ¬æŒ‰ç…§ä¾èµ–å…³ç³»æœ‰åºåœæ­¢æœåŠ¡
4. **å®‰å…¨è®¾è®¡**: è‡ªåŠ¨è·³è¿‡æœªå®‰è£…æˆ–å·²ç¦ç”¨çš„æœåŠ¡ï¼Œä¸ä¼šé€ æˆé”™è¯¯

---

## ğŸ“… ç‰ˆæœ¬ä¿¡æ¯

- **v2.1** (2026-02-08): ç§»é™¤Streamlitï¼ˆç°ç”±Dockerç®¡ç†ï¼‰ï¼Œä¿®å¤PM2è¾“å‡ºæ ¼å¼
- **v2.0** (2026-02-08): å¯åŠ¨å’Œåœæ­¢è„šæœ¬å…¨é¢ä¼˜åŒ–
- **v1.0** (2026-02-07): åˆå§‹ç‰ˆæœ¬

å®Œæ•´å˜æ›´å†å²è¯·æŸ¥çœ‹ `CHANGELOG.md`

---

**ä½œè€…**: Cursor AI  
**è®¸å¯**: ä»…ä¾›ä¸ªäººä½¿ç”¨
